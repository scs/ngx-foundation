{"version":3,"sources":["../../src/reveal/reveal.component.ts"],"names":[],"mappings":"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","file":"reveal.component.js","sourceRoot":"","sourcesContent":["import {\r\n  Directive,\r\n  ElementRef,\r\n  Renderer,\r\n  AfterViewInit,\r\n  OnDestroy,\r\n  ViewContainerRef,\r\n  ComponentRef,\r\n  HostListener,\r\n  Input,\r\n  Output,\r\n  EventEmitter } from '@angular/core';\r\n\r\nimport { document } from '../utils/facade/browser';\r\n\r\nimport { Utils } from '../utils/utils.class';\r\nimport { RevealBackdropComponent } from './reveal-backdrop.component';\r\nimport { ClassName, modalConfigDefaults, RevealOptions, Selector } from './reveal-options.class';\r\n\r\nimport { window } from '../utils/facade/browser';\r\nimport { ComponentLoader } from '../component-loader/component-loader.class';\r\nimport { ComponentLoaderFactory } from '../component-loader/component-loader.factory';\r\n\r\nconst TRANSITION_DURATION = 300;\r\nconst BACKDROP_TRANSITION_DURATION = 150;\r\n\r\n\r\nexport class RevealDirective implements AfterViewInit, OnDestroy {\r\n\r\n  \r\n  public set config(conf: RevealOptions) {\r\n    this._config = this.getConfig(conf);\r\n  }\r\n\r\n  public get config(): RevealOptions {\r\n    return this._config;\r\n  }\r\n\r\n   public shown = new EventEmitter<RevealDirective>();\r\n   public hidden = new EventEmitter<any>();\r\n\r\n  //   public isAnimated: boolean = true;\r\n  // protected timerHideModal: number = 0;\r\n  // protected timerRmBackDrop: number = 0;\r\n  // protected originalBodyPadding: number = 0;\r\n\r\n  private _element: ElementRef;\r\n  private _renderer: Renderer;\r\n  private _config: RevealOptions;\r\n  private _isShown = false;\r\n\r\n  private backdrop: ComponentRef<RevealBackdropComponent>;\r\n  private _backdropLoader: ComponentLoader<RevealBackdropComponent>;\r\n\r\n  \r\n  public onEsc(): void {\r\n      this.hide();\r\n  }\r\n\r\n  constructor(_element: ElementRef, _viewContainerRef: ViewContainerRef, _renderer: Renderer, clf: ComponentLoaderFactory) {\r\n    this._element = _element;\r\n    this._renderer = _renderer;\r\n    this._backdropLoader = clf.createLoader<RevealBackdropComponent>(_element, _viewContainerRef, _renderer);\r\n  }\r\n\r\n  public ngAfterViewInit() {\r\n    this._config = this._config || this.getConfig();\r\n    this._renderer.setElementStyle(this._element.nativeElement, 'display', 'none');\r\n  }\r\n\r\n  public ngOnDestroy() {\r\n\r\n  }\r\n\r\n  public show(): void {\r\n    if (this._isShown) {\r\n      return;\r\n    }\r\n    this._isShown = true;\r\n\r\n    if (document && document.body) {\r\n      this._renderer.setElementClass(document.body, ClassName.OPEN, true);\r\n    }\r\n\r\n    this.showBackdrop(() => {\r\n      this.showElement();\r\n    });\r\n\r\n  }\r\n\r\n  protected showElement(): void {\r\n    // todo: replace this with component loader usage\r\n    if (!this._element.nativeElement.parentNode ||\r\n      (this._element.nativeElement.parentNode.nodeType !== Node.ELEMENT_NODE)) {\r\n      // don't move modals dom position\r\n      if (document && document.body) {\r\n        document.body.appendChild(this._element.nativeElement);\r\n      }\r\n    }\r\n\r\n    this._renderer.setElementStyle(this._element.nativeElement, 'position', 'fixed');\r\n    this._renderer.setElementStyle(this._element.nativeElement, 'display', 'block');\r\n    // this._renderer.setElementProperty(this._element.nativeElement, 'scrollTop', 0);\r\n\r\n    // if (this.isAnimated) {\r\n    //   Utils.reflow(this._element.nativeElement);\r\n    // }\r\n\r\n    this._renderer.setElementClass(this._element.nativeElement, ClassName.IN, true);\r\n\r\n    this.updatePosition();\r\n\r\n    const transitionComplete = () => {\r\n      //   if (this._config.focus) {\r\n          this._element.nativeElement.focus();\r\n      //   }\r\n      this.shown.emit(this);\r\n    };\r\n\r\n    // if (this.isAnimated) {\r\n    //   setTimeout(transitionComplete, TRANSITION_DURATION);\r\n    // } else {\r\n    transitionComplete();\r\n    // }\r\n  }\r\n\r\n  private updatePosition() {\r\n    let width: number = this._element.nativeElement.clientWidth;\r\n    let outerWidth: number = document.body.clientWidth;\r\n    let height: number = this._element.nativeElement.clientHeight;\r\n    let outerHeight: number = document.body.clientHeight;\r\n    let left = (outerWidth - width) / 2;\r\n    let top = Math.max(50, (outerHeight - height) / 3);\r\n    this._renderer.setElementStyle(this._element.nativeElement, 'top', top.toString() + 'px');\r\n    this._renderer.setElementStyle(this._element.nativeElement, 'left', left.toString() + 'px');\r\n  }\r\n\r\n  public hide(event?: Event): void {\r\n    // this.onHide.emit(this);\r\n\r\n    // todo: add an option to prevent hiding\r\n    if (!this._isShown) {\r\n      return;\r\n    }\r\n\r\n    // clearTimeout(this.timerHideModal);\r\n    // clearTimeout(this.timerRmBackDrop);\r\n\r\n    this._isShown = false;\r\n    this._renderer.setElementClass(this._element.nativeElement, ClassName.IN, false);\r\n    // this._addClassIn = false;\r\n\r\n    // if (this.isAnimated) {\r\n    //   this.timerHideModal = setTimeout(() => this.hideModal(), TRANSITION_DURATION);\r\n    // } else {\r\n    this.hideModal(event);\r\n    // }\r\n  }\r\n\r\n  protected hideModal(event?: Event): void {\r\n    // this._renderer.setElementAttribute(this._element.nativeElement, 'aria-hidden', 'true');\r\n    this._renderer.setElementStyle(this._element.nativeElement, 'display', 'none');\r\n    this.showBackdrop(() => {\r\n      if (document && document.body) {\r\n        this._renderer.setElementClass(document.body, ClassName.OPEN, false);\r\n      }\r\n      // this.resetAdjustments();\r\n      // this.resetScrollbar();\r\n      this.hidden.emit(event);\r\n    });\r\n  }\r\n\r\n  // protected resetAdjustments(): void {\r\n  //   this._renderer.setElementStyle(this._element.nativeElement, 'paddingLeft', '');\r\n  //   this._renderer.setElementStyle(this._element.nativeElement, 'paddingRight', '');\r\n  // }\r\n\r\n  // protected resetScrollbar(): void {\r\n  //   document.body.style.paddingRight = this.originalBodyPadding;\r\n  // }\r\n\r\n  protected getConfig(config?: RevealOptions): RevealOptions {\r\n    return Object.assign({}, modalConfigDefaults, config);\r\n  }\r\n\r\n  protected showBackdrop(callback?: Function): void {\r\n    if (this._isShown && this.config.overlay && (!this.backdrop || !this.backdrop.instance.isShown)) {\r\n      this.removeBackdrop();\r\n      this._backdropLoader\r\n        .attach(RevealBackdropComponent)\r\n        .to('body')\r\n        .show();\r\n      this.backdrop = this._backdropLoader._componentRef;\r\n      this._renderer.setElementStyle(this.backdrop.instance.element.nativeElement, 'display', 'block');\r\n\r\n      //   if (this.isAnimated) {\r\n      //     this.backdrop.instance.isAnimated = this.isAnimated;\r\n      //     Utils.reflow(this.backdrop.instance.element.nativeElement);\r\n      //   }\r\n\r\n      this.backdrop.instance.isShown = true;\r\n      this.backdrop.instance.modal = this;\r\n\r\n      if (!callback) {\r\n        return;\r\n      }\r\n\r\n      //   if (!this.isAnimated) {\r\n      callback();\r\n      return;\r\n      //   }\r\n\r\n      //   setTimeout(callback, BACKDROP_TRANSITION_DURATION);\r\n    } else if (!this._isShown && this.backdrop) {\r\n      this.backdrop.instance.isShown = false;\r\n\r\n      let callbackRemove = () => {\r\n        this.removeBackdrop();\r\n        if (callback) {\r\n          callback();\r\n        }\r\n      };\r\n\r\n      //   if (this.backdrop.instance.isAnimated) {\r\n      //     this.timerRmBackDrop = setTimeout(callbackRemove, BACKDROP_TRANSITION_DURATION);\r\n      //   } else {\r\n      callbackRemove();\r\n      //   }\r\n    } else if (callback) {\r\n      callback();\r\n    }\r\n  }\r\n\r\n  protected removeBackdrop(): void {\r\n    this._backdropLoader.hide();\r\n  }\r\n\r\nstatic decorators: DecoratorInvocation[] = [\n{ type: Directive, args: [{\r\n  selector: '[zfReveal]',\r\n  exportAs: 'zf-reveal'\r\n}, ] },\n];\n/** @nocollapse */\nstatic ctorParameters: () => ({type: any, decorators?: DecoratorInvocation[]}|null)[] = () => [\n{type: ElementRef, },\n{type: ViewContainerRef, },\n{type: Renderer, },\n{type: ComponentLoaderFactory, },\n];\nstatic propDecorators: {[key: string]: DecoratorInvocation[]} = {\n'config': [{ type: Input },],\n'shown': [{ type: Output },],\n'hidden': [{ type: Output },],\n'onEsc': [{ type: HostListener, args: ['keydown.esc', ] },],\n};\n}\r\n\ninterface DecoratorInvocation {\n  type: Function;\n  args?: any[];\n}\n"]}